{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "NIXPACKS",
    "buildCommand": "chmod +x ./mvnw 2>/dev/null || true; if [ -f ./mvnw ]; then ./mvnw -B -DskipTests=true clean package; else mvn -B -DskipTests=true clean package; fi",
    "startCommand": "JAR_FILE=$(ls target/*.jar | head -n 1 || true); if [ -z \"$JAR_FILE\" ]; then echo 'No JAR file found!'; ls -la target/; exit 1; else echo \"Found JAR: $JAR_FILE\"; PORT=${PORT:-8080}; exec java -Dserver.port=$PORT -Xmx512m -jar \"$JAR_FILE\"; fi"
  },
  "deploy": {
    "numReplicas": 1,
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10
  },
  "checks": {
    "enabled": true,
    "path": "/actuator/health",
    "initialDelay": 30,
    "timeout": 5
  }
}
